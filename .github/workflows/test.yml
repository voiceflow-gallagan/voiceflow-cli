name: Test

on:
  push:
 # triggers only if push new tag version, like `0.8.4` or else
permissions:
  contents: write
  id-token: write
  packages: write
  
jobs:
  release:
    name: tests
    runs-on: ubuntu-latest
    env:
      DOCKER_CLI_EXPERIMENTAL: "enabled"

    steps:
      - name: Check out code into the Go module directory
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # See: https://goreleaser.com/ci/actions/

      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: stable
        id: go

      - name: Chocolatey üç´üì¶
        run: |
          set -x
          set -v
          go mod download
          go generate ./...
          go run main.go completion bash
          ./scripts/completions.sh
          ./scripts/manpages.sh
